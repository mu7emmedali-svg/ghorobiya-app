<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>الساعة الغروبية</title>

<style>
body{
  margin:0;
  padding:0;
  font-family: "Tahoma", sans-serif;
  background: linear-gradient(135deg,#0d1b2a,#1b263b);
  color:white;
  text-align:center;
}

h1{
  margin-top:40px;
  color:#ffd700;
  font-size:36px;
}

#clock{
  font-size:90px;
  margin:20px 0;
  font-weight:bold;
  color:#ffd700;
  text-shadow:0 0 20px rgba(255,215,0,0.7);
}

.info-line{
  font-size:20px;
  margin:5px 0;
  color:#ddd;
}

.prayer-times{
  margin:40px auto;
  padding:25px;
  width:320px;
  border:2px solid #ffd700;
  border-radius:20px;
  background:#0d1b2a;
}

.prayer-times h2{
  color:#ffd700;
  margin-bottom:15px;
}

.prayer-times div{
  margin:8px 0;
  font-size:20px;
}

.about-section{
  margin:60px auto;
  max-width:650px;
  line-height:1.9;
  font-size:18px;
  color:#eee;
  border-top:1px solid rgba(255,215,0,0.3);
  padding-top:30px;
}

.about-section h2{
  color:#ffd700;
  margin-bottom:15px;
}
</style>
</head>

<body>

<h1>الساعة الغروبية</h1>

<div id="clock">00:00:00</div>

<div id="location" class="info-line">الموقع: إسطنبول – تركيا</div>
<div id="hijriDate" class="info-line">التاريخ الهجري: ...</div>

<div class="prayer-times">
  <h2>أوقات الصلاة (غروبي)</h2>
  <div id="fajr">الفجر: --</div>
  <div id="sunrise">الشروق: --</div>
  <div id="dhuhr">الظهر: --</div>
  <div id="asr">العصر: --</div>
  <div id="maghrib">المغرب: --</div>
  <div id="isha">العشاء: --</div>
</div>

<div class="about-section">
  <h2>ما هي الساعة الغروبية؟</h2>
  <p>
    الساعة الغروبية هي نظام زمني يبدأ فيه اليوم عند غروب الشمس،
    وليس عند منتصف الليل كما هو النظام العالمي.
    كانت هذه الطريقة مستخدمة قديماً في بلاد الشام وبعض المناطق الإسلامية،
    حيث يُحسب الوقت ابتداءً من لحظة الغروب،
    فتكون الساعة الأولى بعد الغروب هي بداية يوم جديد.
  </p>
</div>

<script>

let maghribMinutes = null;

// تحويل الوقت إلى دقائق
function convertToMinutes(timeStr){
  const [h,m] = timeStr.split(":").map(Number);
  return h*60 + m;
}

// تحديث الساعة الغروبية
function updateGhorobiClock(){
  if(maghribMinutes === null) return;

  const now = new Date();
  const currentMinutes = now.getHours()*60 + now.getMinutes();
  let diff = currentMinutes - maghribMinutes;

  if(diff < 0){
    diff += 24*60; // قبل المغرب نحسب من مغرب أمس
  }

  const hours = Math.floor(diff/60);
  const minutes = diff % 60;
  const seconds = now.getSeconds();

  document.getElementById("clock").textContent =
    String(hours).padStart(2,'0') + ":" +
    String(minutes).padStart(2,'0') + ":" +
    String(seconds).padStart(2,'0');
}

// جلب أوقات الصلاة
async function loadData(){
  try{
    const res = await fetch("https://api.aladhan.com/v1/timingsByCity?city=Istanbul&country=Turkey&method=13");
    const data = await res.json();

    const timings = data.data.timings;

    document.getElementById("fajr").textContent = "الفجر: " + timings.Fajr;
    document.getElementById("sunrise").textContent = "الشروق: " + timings.Sunrise;
    document.getElementById("dhuhr").textContent = "الظهر: " + timings.Dhuhr;
    document.getElementById("asr").textContent = "العصر: " + timings.Asr;
    document.getElementById("maghrib").textContent = "المغرب: " + timings.Maghrib;
    document.getElementById("isha").textContent = "العشاء: " + timings.Isha;

    document.getElementById("hijriDate").textContent =
      "التاريخ الهجري: " + data.data.date.hijri.day + " " +
      data.data.date.hijri.month.ar + " " +
      data.data.date.hijri.year + " هـ";

    // تخزين وقت المغرب للدورة الغروبية
    maghribMinutes = convertToMinutes(timings.Maghrib);

    setInterval(updateGhorobiClock,1000);

  }catch(error){
    console.error("خطأ في جلب البيانات:", error);
  }
}

loadData();

</script>

</body>
</html>
